\documentclass{standalone}

\usepackage{luatex85}
\renewcommand{\familydefault}{\sfdefault}
\input figures/figures.sty

\begin{document}

    \begin{tikzpicture}[scale=\scale, every node/.style={scale=\scale}]

        \begin{scope}
            \begin{abstractclass}[text width=\smallTextWidth]{MetropolisAlgorithm}{0, 0}
                \operation[0]{\procedure{getNumChoices}{}: \type{int}}
                \operation[0]{\procedure{try}{observables: \type{Observables}}}
            \end{abstractclass}
        \end{scope}

        \begin{scope}[shift={($(MetropolisAlgorithm.south) + (0 cm, -2.5 cm)$)}]
            \begin{abstractclass}[text width=\mediumTextWidth]{OneParticleMove}{0, 0}
                \inherit{MetropolisAlgorithm}
                \operation{\procedure{construct}{environment: \type{Environment},
                    mixture: \type{Mixture}, shortInteractions: \type{ShortInteractions},
                    dipolarInteractions: \type{DipolarInteractions},
                    changesComponents: \type{ChangesComponent[:]}, canChange: \type{bool[:]},
                    selectorMold: \type{TowerSampler}}}
                \operation{\procedure{destroy}{}}
                \operation{\procedure{setSelector}{}}
            \end{abstractclass}
        \end{scope}

        \begin{scope}[shift={($(OneParticleMove.north) + (9 cm, 0 cm)$)}]
            \begin{abstractclass}[text width=\mediumTextWidth]{TwoParticlesSwitch}{0, 0}
                \inherit{MetropolisAlgorithm}
                \operation{\procedure{construct}{environment: \type{Environment},
                    components: \type{Component[:]}, shortInteractions: \type{ShortInteractions},
                    dipolarInteractions: \type{DipolarInteractions},
                    couples: \type{HeteroCouples}, selectorMold: \type{TowerSampler}}}
                \operation{\procedure{destroy}{}}
                \operation{\procedure{setSelector}{}}
            \end{abstractclass}
        \end{scope}

        \begin{scope}[shift={($(OneParticleMove.north) - (9 cm, 0 cm)$)}]
            \begin{abstractclass}[text width=\mediumTextWidth]{OneParticleExchange}{0, 0}
                \inherit{MetropolisAlgorithm}
                \operation{\procedure{construct}{environment: \type{Environment},
                    mixture: \type{Mixture}, shortInteractions: \type{ShortInteractions},
                    dipolarInteractions: \type{DipolarInteractions}, changes: \type{Changes},
                    canExchange: \type{bool[:]}, selectorMold: \type{TowerSampler}}}
                \operation{\procedure{destroy}{}}
                \operation{\procedure{setSelector}{}}
            \end{abstractclass}
        \end{scope}

        \begin{scope}[shift={($(OneParticleMove.south) - (0 cm, 1.5 cm)$)}]
            \begin{abstractclass}[text width=\mediumTextWidth]{TwoParticlesTransmutation}{0, 0}
                \inherit{MetropolisAlgorithm}
                \operation{\procedure{construct}{environment: \type{Environment},
                    mixture: \type{Mixture}, shortInteractions: \type{ShortInteractions},
                    dipolarInteractions: \type{DipolarInteractions}, changes: \type{Changes},
                    canExchange: \type{bool[:]}, couples: \type{HeteroCouples},
                    selectorMold: \type{TowerSampler}}}
                \operation{\procedure{destroy}{}}
                \operation{\procedure{setSelector}{}}
            \end{abstractclass}
        \end{scope}

        \begin{scope}[shift={($(OneParticleExchange.south |- TwoParticlesTransmutation.north)$)}]
            \begin{abstractclass}[text width=\mediumTextWidth]{BoxVolumeChange}{0, 0}
                \inherit{MetropolisAlgorithm}
                \operation{\procedure{construct}{environment: \type{Environment},
                    mixture: \type{Mixture}, shortInteractions: \type{ShortInteractions},
                    changedBoxSize: \type{ChangedBoxSize}}}
                \operation{\procedure{destroy}{}}
            \end{abstractclass}
        \end{scope}

        \begin{scope}[shift={($(OneParticleExchange.north |- MetropolisAlgorithm.north)$)}]
            \begin{class}[text width=\mediumTextWidth]{MetropolisAlgorithms}{0, 0}
                \UMLattribute{oneParticleTranslation: \type{OneParticleMove}}
                \UMLattribute{oneParticleRotation: \type{OneParticleMove}}
                \UMLattribute{twoParticlesSwitch: \type{TwoParticlesSwitch}}
            \end{class}
        \end{scope}

        \begin{scope}[shift={($(MetropolisAlgorithm.north -| TwoParticlesSwitch)$)}]
            \umlnote[text width=\mediumTextWidth]{\import{}:\\
                \namespace{Environment} :: Environment \\
                \namespace{Mixture} :: Mixture, Component \\
                \namespace{ShortInteractions} :: ShortInteractions \\
                \namespace{DipolarInteractions} :: DipolarInteractions \\
                \namespace{Changes} :: ChangesComponent, Changes, ChangedBoxSize \\
                \namespace{Observables} :: Observables};
        \end{scope}

    \end{tikzpicture}

\end{document}
