\documentclass{standalone}

\input figures/figures.sty

\renewcommand{\familydefault}{\sfdefault}
\begin{document}

    \begin{tikzpicture}[scale=\scale, every node/.style={scale=\scale}]


        \begin{scope}
            \begin{class}[text width=\mediumTextWidth]{ChangesComponent}{0, 0}
                \attribute{translatedPositions: \type{MovedCoordinates}}
                \attribute{rotatedOrientations: \type{MovedCoordinates}}
                \attribute{translationTuner: \type{MoveTuner}}
                \attribute{rotationTuner: \type{MoveTuner}}
                \attribute{exchange: \type{ComponentExchange}}
            \end{class}
        \end{scope}

        \begin{scope}[shift={($(ChangesComponent.north) - (7.5 cm, 0 cm)$)}]
            \begin{abstractclass}[text width=\smallTextWidth]{MovedCoordinates}{0, 0}
                \operation[0]{\procedure{construct}{...}}
                \operation[0]{\procedure{destroy}{}}
                \operation[0]{\procedure{increaseDelta}{}}
                \operation[0]{\procedure{decreaseDelta}{}}
                \operation[0]{\procedure{get}{iParticle: \type{int}}: \type{real[3]}}
            \end{abstractclass}
        \end{scope}

        \begin{scope}[shift={($(ChangesComponent.south) - (0 cm, 1.5 cm)$)}]
            \begin{abstractclass}[text width=\mediumTextWidth]{MoveTuner}{0, 0}
                \operation{\procedure{construct}{movedCoordinates: \type{MovedCoordinates},
                    parameters: \type{MoveTunerParameters}}}
                \operation{\procedure{destroy}{}}
                \operation{\procedure{tune}{tuned: \type{bool}, iStep: \type{int},
                    successRatio: \type{real}}}
            \end{abstractclass}
        \end{scope}

        \begin{scope}[shift={($(MoveTuner.north) + (7.5 cm, 0 cm)$)}]
            \begin{abstractclass}[text width=\smallTextWidth]{ComponentExchange}{0, 0}
                \operation{\procedure{construct}{component: \type{Component}}}
                \operation{\procedure{destroy}{}}
                \operation{\procedure{add}{particle: \type{TemporaryParticle}}}
                \operation{\procedure{remove}{iParticle: \type{int}}}
            \end{abstractclass}
        \end{scope}

        \begin{scope}[shift={($(MovedCoordinates |- MoveTuner.north)$)}]
            \begin{class}[text width=\smallTextWidth]{MoveTunerParameters}{0, 0}
                \attribute{accumulationPeriod: \type{int}}
                \attribute{wantedSuccessRatio: \type{real}}
                \attribute{tolerance: \type{real}}
            \end{class}
        \end{scope}

        \begin{scope}[shift={($(ChangesComponent.north -| ComponentExchange)$)}]
            \umlnote[text width=\smallTextWidth]{\import{}:\\
                \namespace{Mixture} :: Component, TemporaryParticle};
        \end{scope}

        \begin{scope}[on background layer]
            \aggregation{MoveTuner}{\refName{movedCoordinates}}{\numRef{1}}{MovedCoordinates}
        \end{scope}

    \end{tikzpicture}

\end{document}
