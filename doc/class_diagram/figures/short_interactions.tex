\begin{scope}[shift={($(Environment.north) + (-28 cm, 55 cm)$)}, opacity=0.5]
\begin{package}{Short range interactions}
    
    \begin{scope}[opacity=1]
        \begin{abstractclass}[text width=\mediumTextWidth]{ParticlesPotential}{0, 0}
            \operation{construct(periodicBox\type{PeriodicBox}, positions\type{ParticlesPositions})}
            \operation{destroy()}
            \operation{set(pairPotential\type{PairPotential})}
            \operation{visit(overlap\type{bool}, energy\type{double}, particle\type{Particle})}
        \end{abstractclass}
    \end{scope}
            
    \begin{scope}[shift={($(ParticlesPotential.north) + (-12 cm, 0 cm)$)}, opacity=1]
        \begin{abstractclass}[text width=\largeTextWidth]{VisitableCells}{0, 0}
            \operation{construct(mold\type{VisitableList}, periodicBox\type{PeriodicBox},
                                    positions\type{ParticlesPositions}, 
                                    pairPotential\type{PairPotential})}
            \operation{destroy()}
            \operation{visit(overlap\type{bool}, energy\type{double}, particle\type{Particle})}
            \operation{move(from\type{Particle}, to\type{Particle})}
            \operation{add(particle\type{Particle})}
            \operation{remove(particle\type{Particle})}
        \end{abstractclass}
        
        \def\operationsImplementation{}
        \begin{comment}
            \begin{class}[text width=\largeTextWidth]{XYZPBCVisitableCells}{0, -5.5}
                \inherit{VisitableCells}
                \operationsImplementation{}
            \end{class}
            
            \begin{class}[text width=\largeTextWidth]{XYPBCVisitableCells}{0, -7}
                \inherit{VisitableCells}
                \operationsImplementation{}
            \end{class}
        \end{comment}
    \end{scope}

    \begin{scope}[shift={($(VisitableCells.south) + (-7 cm, -3 cm)$)}, opacity=1]
        \begin{abstractclass}[text width=\mediumTextWidth]{VisitableList}{0, 0}
            \operation{construct(periodicBox\type{PeriodicBox})}
            \operation{destroy()}
            \operation{set(iTarger\type{int}, particle\type{Particle})}
            \operation{visit(overlap\type{bool}, energy\type{double}, particle\type{Particle},
                pairPotential\type{PairPotential})}
            \operation{add(particle\type{Particle})}
            \operation{remove(iParticle\type{int})}
        \end{abstractclass}
    \end{scope}
    
    \begin{scope}[shift={($(ParticlesPotential.south) + (0 cm, -2 cm)$)}, opacity=1]
        \begin{abstractclass}[text width=\mediumTextWidth]{PairPotential}{0, 0}
            \operation{construct(potentialDomain\type{PotentialDomain}, 
                potentialExpression\type{PotentialExpression})}
            \operation{destroy()}
            \operation{getMaxDistance()}
            \operation{meet(overlap\type{bool}, energy\type{double}, distance\type{double})}
        \end{abstractclass}
    \end{scope}

    \begin{scope}[shift={($(PairPotential.south) + (0 cm, -1.5 cm)$)}, opacity=1]
    \begin{abstractclass}[text width=\mediumTextWidth]{PotentialExpression}{0, 0}
            \operation{get(distance : double) : double}
        \end{abstractclass}
    \end{scope}

\end{package}
\end{scope}

\begin{scope}[on background layer]
    \aggregation{ParticlesPotential}{periodicBox}{1}{PeriodicBox}
    \aggregation{ParticlesPotential}{positions}{1}{ParticlesPositions}
    \aggregation{ParticlesPotential}{pairPotential}{1}{PairPotential}
    %\aggregation{IntraPairInteration}{diameters}{1}{Diameters}
    %\aggregation{IntraPairInteration}{positions}{1}{ParticlesPositions}
    %\aggregation{InterPairInteration}{interDiameters}{1}{InterDiameters}
    %\aggregation{InterPairInteration}{positions}{2}{ParticlesPositions}
    
    \aggregation{VisitableCells}{pairPotential}{1}{PairPotential}
    \composition{VisitableCells}{visitableList}{1..n}{VisitableList}
    \aggregation{VisitableCells}{periodicBox}{1}{PeriodicBox}
    \aggregation{VisitableList}{periodicBox}{1}{PeriodicBox}
    
    \aggregation{PairPotential}{potentialExpression}{1}{PotentialExpression}
    
    \aggregation{WallsPotential}{pairPotential}{1}{PairPotential}
\end{scope}
